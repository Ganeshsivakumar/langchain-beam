<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper plugin-docs plugin-id-default docs-version-current docs-doc-page docs-doc-id-templates/kafka-to-pinecone" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.6.3">
<title data-rh="true">Kafka to Pinecone | langchain-beam</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://github.com/langchain-beam/img/logo.png"><meta data-rh="true" name="twitter:image" content="https://github.com/langchain-beam/img/logo.png"><meta data-rh="true" property="og:url" content="https://github.com/langchain-beam/docs/templates/kafka-to-pinecone/"><meta data-rh="true" property="og:locale" content="en"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="keywords" content="apache beam, langchain, langchain-beam, PTransform"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Kafka to Pinecone | langchain-beam"><meta data-rh="true" name="description" content="The Kafka to Pinecone Pipeline is a pre-built Apache Beam streaming pipeline that lets you consume real-time text data from Kafka topics, generate embeddings using OpenAI models, and store the vectors in Pinecone for similarity search and retrieval. The pipeline automatically handles windowing, embedding generation, and upserts to pinecone vector db, turning live Kafka streams into vectors for semantic search and retrieval in Pinecone."><meta data-rh="true" property="og:description" content="The Kafka to Pinecone Pipeline is a pre-built Apache Beam streaming pipeline that lets you consume real-time text data from Kafka topics, generate embeddings using OpenAI models, and store the vectors in Pinecone for similarity search and retrieval. The pipeline automatically handles windowing, embedding generation, and upserts to pinecone vector db, turning live Kafka streams into vectors for semantic search and retrieval in Pinecone."><link data-rh="true" rel="icon" href="/langchain-beam/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://github.com/langchain-beam/docs/templates/kafka-to-pinecone/"><link data-rh="true" rel="alternate" href="https://github.com/langchain-beam/docs/templates/kafka-to-pinecone/" hreflang="en"><link data-rh="true" rel="alternate" href="https://github.com/langchain-beam/docs/templates/kafka-to-pinecone/" hreflang="x-default"><link rel="preconnect" href="https://www.google-analytics.com">
<link rel="preconnect" href="https://www.googletagmanager.com">
<script async src="https://www.googletagmanager.com/gtag/js?id=G-LJN8GV9JEH"></script>
<script>function gtag(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","G-LJN8GV9JEH",{anonymize_ip:!0})</script><link rel="stylesheet" href="/langchain-beam/assets/css/styles.18d1f50f.css">
<script src="/langchain-beam/assets/js/runtime~main.4c8bdf27.js" defer="defer"></script>
<script src="/langchain-beam/assets/js/main.186494f9.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return window.localStorage.getItem("theme")}catch(t){}}();t(null!==e?e:"light")}(),function(){try{const n=new URLSearchParams(window.location.search).entries();for(var[t,e]of n)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/langchain-beam/"><div class="navbar__logo"><img src="/langchain-beam/img/logo.png" alt="langchain-beam logo" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="/langchain-beam/img/logo.png" alt="langchain-beam logo" class="themedComponent_mlkZ themedComponent--dark_xIcU"></div><b class="navbar__title text--truncate">Langchain-Beam</b></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/langchain-beam/docs/intro/">Docs</a></div><div class="navbar__items navbar__items--right"><a href="https://javadoc.io/doc/io.github.ganeshsivakumar/langchain-beam/latest/index.html" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">Javadoc<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><a href="https://github.com/Ganeshsivakumar/langchain-beam/tree/main/example/langchain-beam-example/src/main/java/com/langchainbeam/example" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">Examples<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><a href="https://github.com/Ganeshsivakumar/langchain-beam" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)" aria-live="polite" aria-pressed="false"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="navbarSearchContainer_Bca1"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0"><div class="docsWrapper_hBAB"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docRoot_UBD9"><aside class="theme-doc-sidebar-container docSidebarContainer_YfHR"><div class="sidebarViewport_aRkj"><div class="sidebar_njMd"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/langchain-beam/docs/intro/">Introduction</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/langchain-beam/docs/category/how-to-guides/">How-To guides</a><button aria-label="Expand sidebar category &#x27;How-To guides&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/langchain-beam/docs/category/tutorials/">Tutorials</a><button aria-label="Expand sidebar category &#x27;Tutorials&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/langchain-beam/docs/category/conceptual-guide/">Conceptual guide</a><button aria-label="Expand sidebar category &#x27;Conceptual guide&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" href="/langchain-beam/docs/category/templates/">Templates</a><button aria-label="Collapse sidebar category &#x27;Templates&#x27;" aria-expanded="true" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/langchain-beam/docs/templates/kafka-to-pinecone/">Kafka to Pinecone</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/langchain-beam/docs/templates/llm-batch-process/">LLM batch processor</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/langchain-beam/docs/category/integrations/">Integrations</a><button aria-label="Expand sidebar category &#x27;Integrations&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li></ul></nav></div></div></aside><main class="docMainContainer_TBSr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/langchain-beam/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><a class="breadcrumbs__link" itemprop="item" href="/langchain-beam/docs/category/templates/"><span itemprop="name">Templates</span></a><meta itemprop="position" content="1"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">Kafka to Pinecone</span><meta itemprop="position" content="2"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>Kafka to Pinecone</h1></header>
<p>The Kafka to Pinecone Pipeline is a pre-built Apache Beam streaming pipeline that lets you consume real-time text data from Kafka topics, generate embeddings using OpenAI models, and store the vectors in Pinecone for similarity search and retrieval. The pipeline automatically handles windowing, embedding generation, and upserts to pinecone vector db, turning live Kafka streams into vectors for semantic search and retrieval in Pinecone.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="what-it-does-️">What It Does 🛠️<a href="#what-it-does-️" class="hash-link" aria-label="Direct link to What It Does 🛠️" title="Direct link to What It Does 🛠️">​</a></h2>
<p>This template:</p>
<ul>
<li>Consumes streaming text data from Kafka topics in real-time</li>
<li>Applies windowing to batch messages for efficient processing (10-second fixed windows)</li>
<li>Generates embeddings using OpenAI embedding models via the <a href="https://github.com/Ganeshsivakumar/langchain-beam" target="_blank" rel="noopener noreferrer">LangchainBeam</a> library</li>
<li>Writes vector embeddings to Pinecone with configurable index and namespace settings</li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="use-cases-">Use Cases 📦<a href="#use-cases-" class="hash-link" aria-label="Direct link to Use Cases 📦" title="Direct link to Use Cases 📦">​</a></h2>
<ul>
<li>Real-time semantic search indexing</li>
<li>Live recommendation systems</li>
<li>Real-time knowledge base updates</li>
<li>Event-driven vector database population</li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="template-parameters-️">Template Parameters ⚙️<a href="#template-parameters-️" class="hash-link" aria-label="Direct link to Template Parameters ⚙️" title="Direct link to Template Parameters ⚙️">​</a></h2>
<table><thead><tr><th>Parameter</th><th>Description</th></tr></thead><tbody><tr><td><code>brokers</code></td><td>Kafka bootstrap servers, comma-separated (e.g., <code>broker_2:9092,broker_2:9092</code>)</td></tr><tr><td><code>topic</code></td><td>Kafka topic to consume messages from (e.g., <code>text-content</code>, <code>documents</code>)</td></tr><tr><td><code>embeddingModel</code></td><td>OpenAI embedding model name (e.g., <code>text-embedding-3-small</code>)</td></tr><tr><td><code>openaiApiKey</code></td><td>Your OpenAI API key for embedding generation (e.g., <code>sk-proj-BX_6MwMEV5_...</code>)</td></tr><tr><td><code>pineconeApiKey</code></td><td>Your Pinecone API key for vector database access</td></tr><tr><td><code>pineconeIndex</code></td><td>Name of the Pinecone index to write vectors to (e.g., <code>my-search-index</code>)</td></tr><tr><td><code>pineconeNamespace</code></td><td>Pinecone namespace for organizing vectors (e.g., <code>production</code>, <code>staging</code>)</td></tr><tr><td><code>pineconeApiUrl</code></td><td>Pinecone API endpoint URL for your environment</td></tr></tbody></table>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="pipeline-architecture-️">Pipeline Architecture 🏗️<a href="#pipeline-architecture-️" class="hash-link" aria-label="Direct link to Pipeline Architecture 🏗️" title="Direct link to Pipeline Architecture 🏗️">​</a></h2>
<p>This pipeline continuously consumes messages from a Kafka topic using Apache Beam’s KafkaIO connector. It’s set up to read only new messages arriving after the pipeline starts, as Kafka consumer setting that resets offsets to the latest available data (<code>AUTO_OFFSET_RESET_CONFIG : &quot;latest&quot;</code>). The pipeline currently expects both message keys and values as plain strings, deserialized using Kafka’s <code>StringDeserializer</code>. Incoming messages are grouped into fixed 10-second windows to batch processing and limit the frequency of calls to external services like OpenAI and Pinecone, helping to prevent overload. Each message’s content is sent to an OpenAI embedding model via LangchainBeam, which generates vector embeddings. These embeddings are then upserted into a Pinecone vector database with the specified index and namespace.</p>
<p>some kafka clusters might be setup up with different serialization formats such as Avro, or advanced Kafka authentication mechanisms. While these are not yet supported in this template, we plan to add them soon. We welcome your feature requests and contributions please open an issue on GitHub repository to share your ideas.</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="openai-api-calls-and-batching">OpenAI API Calls and Batching<a href="#openai-api-calls-and-batching" class="hash-link" aria-label="Direct link to OpenAI API Calls and Batching" title="Direct link to OpenAI API Calls and Batching">​</a></h4>
<p>Currently, even though the pipeline groups messages into fixed 10-second windows to control processing frequency, it still sends embedding requests individually for each message within those windows. This means the number of OpenAI API calls scales with message volume, which may impact cost and rate limits.</p>
<p>In future updates, we plan to implement true batch embedding calls—sending multiple messages in a single API request—to significantly reduce the number of calls, lower costs.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="how-to-run-">How to Run 🚀<a href="#how-to-run-" class="hash-link" aria-label="Direct link to How to Run 🚀" title="Direct link to How to Run 🚀">​</a></h2>
<p>You can deploy this streaming pipeline using the Beam runner of your choice.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="1-google-cloud-dataflow">1. Google Cloud Dataflow<a href="#1-google-cloud-dataflow" class="hash-link" aria-label="Direct link to 1. Google Cloud Dataflow" title="Direct link to 1. Google Cloud Dataflow">​</a></h3>
<p>This pipeline is built and packaged as a <a href="https://cloud.google.com/dataflow/docs/guides/templates/using-flex-templates" target="_blank" rel="noopener noreferrer">Dataflow Flex Template</a>, and the template file (<code>gs://langbeam-cloud/templates/kafka-to-pinecone.json</code>) is publicly accessible. This means you can run it directly in your own GCP project by using the gcloud CLI with appropriate parameters.</p>
<p>The pipeline source code is fully <a href="https://github.com/Ganeshsivakumar/langchain-beam" target="_blank" rel="noopener noreferrer">open source on GitHub</a>. You&#x27;re free to fork the repository, customize the pipeline, rebuild it as a Flex Template, and deploy it using your own GCP infrastructure.</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="run-template">Run Template:<a href="#run-template" class="hash-link" aria-label="Direct link to Run Template:" title="Direct link to Run Template:">​</a></h4>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">gcloud dataflow flex-template run &quot;kafka-to-pinecone-stream&quot; \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --template-file-gcs-location=&quot;gs://langbeam-cloud/templates/kafka-to-pinecone.json&quot; \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --region=&quot;us-east1&quot; \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --project=&quot;your-project-id&quot; \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --network=&quot;default&quot; \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --subnetwork=&quot;https://www.googleapis.com/compute/v1/projects/project-id/regions/us-east1/subnetworks/default&quot; \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --staging-location=&quot;gs://your-stage-bucket/stage/&quot; \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --temp-location=&quot;gs://your-stage-bucket/temp/&quot; \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --parameters=&quot;brokers=your-kafka-cluster:9092,topic=text-content,embeddingModel=text-embedding-ada-002,openaiApiKey=your_openai_key,pineconeApiKey=your_pinecone_key,pineconeIndex=search-index,pineconeNamespace=production,pineconeApiUrl=https://your-index.svc.us-east1-gcp.pinecone.io&quot;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>If you&#x27;d like to host the template in your own GCP project:</p>
<ul>
<li>
<p><strong>Fork the Langchain-Beam repo</strong> and clone it locally.<br>
<!-- -->You’ll find the <code>kafka-to-pinecone</code> template under the <code>templates/</code> directory.</p>
</li>
<li>
<p><strong>Build the template</strong> using Maven:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">mvn clean package -Prunner-dataflow</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
</li>
<li>
<p><strong>Use the <code>gcloud</code> CLI</strong> to run Dataflow Flex Template Build command.<br>
<!-- -->This will:</p>
<ul>
<li>Push your pipeline JAR as a container image to Artifact Registry</li>
<li>Generate a <code>template.json</code> file in your GCS bucket, which acts as a pointer to your pipeline image and contains configuration metadata</li>
</ul>
</li>
</ul>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">gcloud dataflow flex-template build gs://your-bucket/templates/kafka-to-pinecone.json \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --image-gcr-path=us-docker.pkg.dev/your-project/your-repo/kafka-to-pinecone:latest \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --jar=/your-folder-path/langchain-beam/templates/kafka-to-pinecone/target/kafka-to-pinecone-dataflow.jar \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --env=FLEX_TEMPLATE_JAVA_MAIN_CLASS=com.templates.langchainbeam.KafkaToPineconePipeline \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --flex-template-base-image=JAVA17 \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --metadata-file=/your-folder-path/langchain-beam/templates/kafka-to-pinecone/src/main/metadata/metadata.json \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --sdk-language=JAVA</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Now the template is built and hosted your GCS path. you can pass GCS template file to run command to execute the template on dataflow</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="2-apache-flink">2. Apache Flink<a href="#2-apache-flink" class="hash-link" aria-label="Direct link to 2. Apache Flink" title="Direct link to 2. Apache Flink">​</a></h3>
<p>If you have an Apache Flink standalone cluster, you can submit the template as a job using the prebuilt Docker image.</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">docker run --rm \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  -e FLINK_MASTER=host.docker.internal:8081 \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  -e FLINK_VERSION=1.18 \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  us-docker.pkg.dev/ptransformers/langbeam-cloud/templates/flink/kafka-to-pinecone:latest \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --runner=FlinkRunner \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --brokers=your-kafka-cluster:9092 \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --topic=text-content \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --embeddingModel=text-embedding-ada-002 \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --openaiApiKey=your_openai_key \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --pineconeApiKey=your_pinecone_key \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --pineconeIndex=search-index \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --pineconeNamespace=production \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --pineconeApiUrl=https://your-index.svc.us-east1-gcp.pinecone.io</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="how-it-works">How It Works<a href="#how-it-works" class="hash-link" aria-label="Direct link to How It Works" title="Direct link to How It Works">​</a></h4>
<p>The pipeline is built and packaged as a JAR. Since Apache Beam’s Flink Runner must be compatible with your Flink version, there are multiple JARs available—each tailored to a specific Beam and Flink version combination.
Refer to the Flink version <a href="https://beam.apache.org/documentation/runners/flink/#flink-version-compatibility" target="_blank" rel="noopener noreferrer">compatibility matrix</a> to choose the correct version.</p>
<ul>
<li>
<p>The container downloads the appropriate .jar file from GCS based on <em><strong>FLINK_VERSION</strong></em> (your flink cluster version) with correct beam and runner depedencies</p>
</li>
<li>
<p>It uses the Flink CLI (flink run) to submit the job to the Flink cluster (as specified by <code>FLINK_MASTER</code>)</p>
</li>
<li>
<p>All dependencies—including Java 17 and the Flink CLI—are preinstalled in the image, so you don’t need to set up anything else.</p>
</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="3-langbeam-managed-cloud">3. LangBeam (Managed Cloud)<a href="#3-langbeam-managed-cloud" class="hash-link" aria-label="Direct link to 3. LangBeam (Managed Cloud)" title="Direct link to 3. LangBeam (Managed Cloud)">​</a></h3>
<p>TO-DO:</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="4-locally">4. Locally<a href="#4-locally" class="hash-link" aria-label="Direct link to 4. Locally" title="Direct link to 4. Locally">​</a></h3>
<p>You can also run the template locally using the Apache Beam DirectRunner. This is useful for testing, debugging, or running small jobs without setting up a full cluster.</p>
<p>Prerequisites:</p>
<ul>
<li>JDK 17</li>
<li>Maven</li>
</ul>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="run-with-maven">Run with Maven<a href="#run-with-maven" class="hash-link" aria-label="Direct link to Run with Maven" title="Direct link to Run with Maven">​</a></h4>
<p>Clone the repository:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">git clone https://github.com/Ganeshsivakumar/langchain-beam.git</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">cd langchain-beam/templates/kafka-to-pinecone</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Build the template:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">mvn clean package -Prunner-direct</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Run with direct runner:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">java -cp target/kafka-to-pinecone-direct.jar \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  com.templates.langchainbeam.KafkaToPineconePipeline \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --runner=DirectRunner \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --brokers=localhost:9092 \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --topic=my-topic \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --embeddingModel=text-embedding-3-small \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --openaiApiKey=your_openai_key \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --pineconeApiKey=your_pinecone_api_key \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --pineconeApiUrl=https://your-pinecone-index.svc.your-region.pinecone.io \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --pineconeIndex=your-index-name \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --pineconeNamespace=your-namespace</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="template-support-">Template Support 🧰<a href="#template-support-" class="hash-link" aria-label="Direct link to Template Support 🧰" title="Direct link to Template Support 🧰">​</a></h2>
<p>This template is fully open source and part of the <a href="https://github.com/Ganeshsivakumar/langchain-beam" target="_blank" rel="noopener noreferrer">Langchain-Beam</a> project.</p>
<p>Feel free to:</p>
<ul>
<li>
<p>🔧 Fork and customize the template to suit your specific use case, deploy it on your own infrastructure, or extend it to support new LLMs, embedding providers, or output formats.</p>
</li>
<li>
<p>🌱 Submit a PR if you&#x27;d like to contribute improvements, add new features, or even create entirely new   templates for other vector DBs or embedding models.</p>
</li>
<li>
<p>🐞 Create an issue if you run into any problems running the template on Flink, Dataflow, or locally — we&#x27;re happy to help troubleshoot!</p>
</li>
</ul></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="row margin-top--sm theme-doc-footer-edit-meta-row"><div class="col"><a href="https://github.com/Ganeshsivakumar/langchain-beam/tree/main/docs/docs-site/docs/docs/templates/kafka-to-pinecone.md" target="_blank" rel="noopener noreferrer" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_JAkA"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href="/langchain-beam/docs/category/templates/"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Templates</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/langchain-beam/docs/templates/llm-batch-process/"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">LLM batch processor</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#what-it-does-️" class="table-of-contents__link toc-highlight">What It Does 🛠️</a></li><li><a href="#use-cases-" class="table-of-contents__link toc-highlight">Use Cases 📦</a></li><li><a href="#template-parameters-️" class="table-of-contents__link toc-highlight">Template Parameters ⚙️</a></li><li><a href="#pipeline-architecture-️" class="table-of-contents__link toc-highlight">Pipeline Architecture 🏗️</a></li><li><a href="#how-to-run-" class="table-of-contents__link toc-highlight">How to Run 🚀</a><ul><li><a href="#1-google-cloud-dataflow" class="table-of-contents__link toc-highlight">1. Google Cloud Dataflow</a></li><li><a href="#2-apache-flink" class="table-of-contents__link toc-highlight">2. Apache Flink</a></li><li><a href="#3-langbeam-managed-cloud" class="table-of-contents__link toc-highlight">3. LangBeam (Managed Cloud)</a></li><li><a href="#4-locally" class="table-of-contents__link toc-highlight">4. Locally</a></li></ul></li><li><a href="#template-support-" class="table-of-contents__link toc-highlight">Template Support 🧰</a></li></ul></div></div></div></div></main></div></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Docs</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/langchain-beam/docs/intro/">Tutorial</a></li></ul></div><div class="col footer__col"><div class="footer__title">More</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://github.com/Ganeshsivakumar/langchain-beam" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div></div></div></footer></div>
</body>
</html>